openapi: 3.0.0
info:
  description: API to access the MercadoLibre service in the Sysmika SDK. Provides a gateway to operations on the MercadoLibre platform
  version: "0.1"
  title: MercadoLibre API
  contact:
    email: gaston.doval@globant.com
tags:
  - name: admins
    description: QA/Production secured calls
  - name: developers
    description: Endpoints used for development and testing

servers:
  - url: 127.0.1:5000
    description: For local development using Flask

paths:
  /user/test:
    get:
      tags:
        - developers
      summary: Creates a test user on a MercadoLibre account
      operationId: create_test_user
      description: Uses an access token to create a test user. This user can be used to test the basic actions on the MercadoLibre platform
      responses:
        '200':
          description: User created
          content:
            application/json:
              schema:
                type: object
                $ref: "../specs/schemas/test-user.json"
        400:
          description: Invalid grant
          content:
            application/json:
              schema:
                type: string
      parameters:
        - in: header
          name: access_token
          description: Token to authenticate operations on the MercadoLibre platform.
          required: true
          example: "{access_token: AG-90128301}"
          content:
            application/json:
              schema:
                type: string
        - in: header
          name: site_id
          example: "{site_id: MLA}"
          content:
            application/json:
              schema:
                type: "string"
          description: Id of the MercadoLibre site (Country)

  /auth/access_token:
    get:
      tags:
        - developers
        - admins
      summary: Generates an access token on the MercadoLibre site.
      operationId: generate_access_token
      responses:
        '200':
          description: An AccessToken object is generated.
          content:
            application/json:
              schema:
                type: object
                $ref: "../specs/schemas/access-token.json"
        '400':
          description: Missing requried header
          content:
            application/json:
              schema:
                type: string
        default:
          description: "Access token creation failed"
          content:
            application/json:
              schema:
                type: string
      parameters:
        - in: header
          name: tg_code
          required: true
          example: "{tg_code: TG-123456}"
          content:
            application/json:
              schema:
                type: "string"
          description: "Code generated by the MercadoLibre app on user authentication"
        - in: header
          name: redirect_url
          required: true
          example: "{redirect_url: http://sysmika.com.ar}"
          content:
            application/json:
              schema:
                type: "string"
          description: "Redirect URL specified on the user app on MercadoLibre"
        - in: header
          name: app_id
          required: true
          description: "Id of the MercadoLibre integration app. Obtainable  in developers.mercadolibre"
          example: "{app_id: APP-2134}"
          content:
            application/json:
              schema:
                type: string
        - in: header
          name: app_secret
          required: true
          description: "Secret Id of the MercadoLibre integration app. Obtainable  in developers.mercadolibre"
          example: "{app_secret: SG-20983}"
          content:
            application/json:
              schema:
                type: string

  /auth/refresh_token:
    get:
      tags:
        - developer
        - admins
      summary: Refresh the access token, before expiration (after 6 hours of being generated)
      operationId: refresh_access_token
      responses:
        '200':
          description: An AccessToken object is generated.
          content:
            application/json:
              schema:
                type: object
                $ref: "../specs/schemas/access-token.json"
        '400':
          description: Missing requried header
          content:
            application/json:
              schema:
                type: string
        default:
          description: Failed request
          content:
            application/json:
              schema:
                type: string
      parameters:
        - in: header
          name: refreh_token
          required: true
          example: "{refresh_token: TG-1234}"
          content:
            application/json:
              schema:
                type: string
          description: "Code needed to fresh the access token. It generates automaically when requesting an access token"
        - in: header
          name: app_id
          required: true
          description: "Id of the MercadoLibre integration app. Obtainable  in developers.mercadolibre"
          example: "{app_id: APP-2134}"
          content:
            application/json:
              schema:
                type: string
        - in: header
          name: app_secret
          required: true
          description: "Secret Id of the MercadoLibre integration app. Obtainable  in developers.mercadolibre"
          example: "{app_secret: SG-20983}"
          content:
            application/json:
              schema:
                type: string

  /categories:
    get:
      tags:
        - developer
        - admin
      summary: Retrieves all categories with their childs
      operationId: get_categories
      responses:
        '200':
          description: An array with all categories is returned
          content:
            application/json:
              schema:
                type: object
                $ref: "../specs/schemas/inmboliaria_categories.json"
        default:
          description: Failed request
          content:
            application/json:
              schema:
                type: string

  /categories/{category_id}:
    get:
      tags:
        - developer
        - admin
      summary: Retrieves all attributes for a specific category
      operationId: get_inmobiliaria_category_description
      responses:
        '200':
          description: An array with all attributes
          content:
            application/json:
              schema:
                type: string
        default:
          description: Failed request
          content:
            application/json:
              schema:
                type: string
  /publish:
    post:
      tags:
        - developer
        - admin
      description: Publishes an offer on MercadLibre
      operationId: post_real_state_publication
      responses:
        '200':
          description: Successfully response for MercadoLibre
          content:
            application/json:
              schema:
                type: object
                $ref: "../specs/schemas/mercadolibre_success.json"
        '500':
          description: Missing required header
          content:
            application/json:
              schema:
                type: string
        default:
          description: Invalid grant
          content:
            application/json:
              schema:
                type: string
      parameters:
        - in: header
          name: access_token
          description: Token to authenticate operations on the MercadoLibre platform.
          required: true
          example: "{access_token: AG-90128301}"
          content:
            application/json:
              schema:
                type: string